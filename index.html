<!DOCTYPE html>
<html lang="ko">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í€´ì¦ˆì‡¼</title>
  <!-- Teachable Machine ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js"></script>
    
    <style>
    * {
        margin: 0;
        padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Malgun Gothic', sans-serif;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    /* ë©”ì¸ í™”ë©´ - ë²„íŠ¼ ì„ íƒ */
    #mainScreen {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      animation: gradientShift 8s ease infinite;
      background-size: 200% 200%;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ë©”ì¸ í™”ë©´ ì‹œì‘ ì˜¤ë²„ë ˆì´ */
    .start-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.1);
      z-index: 10000;
      display: flex;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease-out;
    }

    .start-overlay.hidden {
      display: none;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .start-overlay-content {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.5);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-family: 'Malgun Gothic', sans-serif;
    }

    .start-overlay-description {
      font-size: 24px;
      line-height: 1.6;
      color: #333;
      text-align: center;
      margin-bottom: 30px;
      font-family: 'Malgun Gothic', sans-serif;
    }

    .start-overlay-button {
      padding: 15px 40px;
      font-size: 20px;
      font-weight: bold;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Malgun Gothic', sans-serif;
    }

    .start-overlay-button:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      transform: translateY(-2px);
    }

    .start-overlay-button:active {
      transform: translateY(0);
    }

    .difficulty-button {
      width: 300px;
      height: 80px;
      font-size: 24px;
      font-weight: bold;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
      position: relative;
      overflow: hidden;
    }

    .difficulty-button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .difficulty-button:hover::before {
      width: 400px;
      height: 400px;
    }

    .difficulty-button:hover {
      transform: scale(1.08) translateY(-3px);
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.6);
    }

    .difficulty-button:active {
      transform: scale(1.02) translateY(-1px);
    }

    /* í€´ì¦ˆ í™”ë©´ */
    .quiz-screen {
        width: 100%;
        height: 100%;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .quiz-screen.active {
      display: flex;
    }

    /* ë‚œì´ë„ í•˜ - ë°ì€ íŒŒë€ìƒ‰ ë°°ê²½ */
    #easyScreen {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      animation: gradientShift 8s ease infinite;
      background-size: 200% 200%;
    }

    /* ë‚œì´ë„ ì¤‘ - ë°ì€ ë³´ë¼ìƒ‰ ë°°ê²½ */
    #mediumScreen {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      animation: gradientShift 8s ease infinite;
      background-size: 200% 200%;
    }

    /* ë‚œì´ë„ ìƒ - ë°ì€ ì£¼í™©ìƒ‰ ë°°ê²½ */
    #hardScreen {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      animation: gradientShift 8s ease infinite;
      background-size: 200% 200%;
    }

    .welcome-message {
      font-size: 36px;
      font-weight: bold;
      color: #fff;
      text-align: center;
      margin-bottom: 50px;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    #easyScreen .welcome-message,
    #mediumScreen .welcome-message,
    #hardScreen .welcome-message {
      color: #fff;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
    }

    .question-container {
      width: 80%;
      max-width: 800px;
      padding: 40px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 25px;
      box-shadow: 0 15px 40px rgba(0,0,0,0.2);
      display: none;
      position: relative;
      backdrop-filter: blur(10px);
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    } 

    .question-container.active {
      display: block;
    }

    .question-number {
      font-size: 18px;
      color: #666;
      margin-bottom: 20px;
    }

    .question-text {
      font-size: 28px;
      color: #333;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    .answer-input {
      width: 100%;
      padding: 15px;
      font-size: 20px;
      border: 2px solid #333;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .options-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }


    .option-button {
      width: 100%;
      padding: 20px;
      font-size: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .option-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .option-button:hover::before {
      left: 100%;
    }

    .option-button:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      transform: translateX(10px) scale(1.02);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .option-button.selected {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: #fff;
      transform: translateX(10px) scale(1.05);
      box-shadow: 0 8px 25px rgba(240, 147, 251, 0.6);
      animation: selectedPulse 1.5s ease-in-out infinite;
    }

    @keyframes selectedPulse {
      0%, 100% { box-shadow: 0 8px 25px rgba(240, 147, 251, 0.6); }
      50% { box-shadow: 0 8px 35px rgba(240, 147, 251, 0.9); }
    }

    .submit-button {
      width: 100%;
      padding: 15px;
      font-size: 20px;
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(250, 112, 154, 0.4);
      font-weight: bold;
      position: relative;
      overflow: hidden;
    }

    .submit-button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .submit-button:hover::before {
      width: 400px;
      height: 400px;
    }

    .submit-button:hover {
      background: linear-gradient(135deg, #fee140 0%, #fa709a 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(250, 112, 154, 0.6);
    }

    .submit-button:disabled {
      background: linear-gradient(135deg, #d0d0d0 0%, #b0b0b0 100%);
      cursor: not-allowed;
      box-shadow: none;
    }

    .back-button {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid rgba(102, 126, 234, 0.5);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      font-weight: bold;
      color: #667eea;
    }

    .back-button:hover {
      background: rgba(255, 255, 255, 1);
      border-color: #667eea;
      transform: translateX(-3px);
      box-shadow: 0 6px 15px rgba(102, 126, 234, 0.3);
    }

    .result-message {
      font-size: 24px;
      margin-top: 20px;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
    }

    .result-message.correct {
      background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
      color: #fff;
      position: relative;
      box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5);
    }

    .result-message.incorrect {
      background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
      color: #fff;
      position: relative;
      box-shadow: 0 8px 25px rgba(244, 67, 54, 0.5);
    }

    /* ì •ë‹µ/ì˜¤ë‹µ ì•„ì´ì½˜ ì• ë‹ˆë©”ì´ì…˜ */
    .result-icon {
      display: inline-block;
      font-size: 48px;
      margin: 0 10px;
    }

    .checkmark-icon {
      animation: rotateIn 0.6s ease-out;
    }

    .x-icon {
      animation: fadeInScale 0.5s ease-out;
    }

    @keyframes rotateIn {
      0% {
        transform: rotate(-180deg) scale(0);
        opacity: 0;
      }
      50% {
        transform: rotate(10deg) scale(1.2);
      }
      100% {
        transform: rotate(0deg) scale(1);
        opacity: 1;
      }
    }

    @keyframes fadeInScale {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      50% {
        transform: scale(1.3);
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* ê²°ê³¼ ë©”ì‹œì§€ ë°”ìš´ìŠ¤ ì¸ ì• ë‹ˆë©”ì´ì…˜ */
    .result-message {
      animation: bounceIn 0.6s ease-out;
    }

    @keyframes bounceIn {
      0% {
        transform: scale(0.3) translateY(-100px);
        opacity: 0;
      }
      50% {
        transform: scale(1.05) translateY(10px);
      }
      70% {
        transform: scale(0.9) translateY(-5px);
      }
      100% {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    /* í™”ë©´ í”ë“¤ë¦¼ ì• ë‹ˆë©”ì´ì…˜ (ì˜¤ë‹µ ì‹œ) */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
      20%, 40%, 60%, 80% { transform: translateX(10px); }
    }

    .quiz-screen.shake {
      animation: shake 0.5s ease-in-out;
    }

    /* ë°°ê²½ ê¹œë¹¡ì„ íš¨ê³¼ */
    @keyframes flash {
      0%, 100% { opacity: 0; }
      50% { opacity: 0.6; }
    }

    .quiz-screen.flash-correct::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(76, 175, 80, 0.4);
      pointer-events: none;
      z-index: 1;
      animation: flash 0.3s ease-in-out;
    }

    .quiz-screen.flash-incorrect::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
        width: 100%;
        height: 100%;
      background: rgba(244, 67, 54, 0.4);
      pointer-events: none;
      z-index: 1;
      animation: flash 0.3s ease-in-out;
    }

    /* ë³„ íš¨ê³¼ */
  /*  .star {
      position: fixed;
      color: #ffd700;
      font-size: 30px;
      pointer-events: none;
      z-index: 1000;
      animation: starFall 1s ease-out forwards;
    } */

     @keyframes starFall {
      0% {
        transform: translateY(0) rotate(0deg) scale(0);
        opacity: 1;
      }
      50% {
        transform: translateY(-50px) rotate(180deg) scale(1.5);
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) rotate(360deg) scale(0);
        opacity: 0;
      }
    }

    /* í­ì£½ íš¨ê³¼ */
    .confetti {
      position: fixed;
      width: 5px;
      height: 5px;
      pointer-events: none;
      z-index: 1000;
      animation: confettiFall 4s ease-out forwards;
    }

    .confetti:nth-child(2n) { background: #00ff00; }
    .confetti:nth-child(3n) { background: #0000ff; }
    .confetti:nth-child(4n) { background: #ffff00; }
    .confetti:nth-child(5n) { background: #ff00ff; }

    @keyframes confettiFall {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(500px, 800px) translateX(300px) rotate(720deg);
        opacity: 0;
      }
    }


    /* ì›¹ìº  ë° Teachable Machine ê´€ë ¨ ìŠ¤íƒ€ì¼ */
    .camera-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 320px;
      height: 240px;
      border: 3px solid #667eea;
      border-radius: 15px;
      overflow: hidden;
      background: #000;
      z-index: 10000;
      pointer-events: auto;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      animation: cameraPulse 3s ease-in-out infinite;
    }

    @keyframes cameraPulse {
      0%, 100% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
      50% { box-shadow: 0 8px 35px rgba(102, 126, 234, 0.7); }
    }

    #webcam {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scaleX(-1); /* ê±°ìš¸ ëª¨ë“œ */
    }

    .prediction-info {
      position: fixed;
      bottom: 270px;
      right: 20px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%);
      color: #fff;
      padding: 15px;
      border-radius: 12px;
      font-size: 16px;
      z-index: 10001;
      min-width: 200px;
      pointer-events: none;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      backdrop-filter: blur(10px);
    }

    .prediction-item {
      margin: 5px 0;
      padding: 5px;
    }

    .prediction-item.highest {
      background: rgba(255, 255, 255, 0.3);
      font-weight: bold;
      border-radius: 5px;
      animation: highlightPulse 1.5s ease-in-out infinite;
    }

    @keyframes highlightPulse {
      0%, 100% { background: rgba(255, 255, 255, 0.3); }
      50% { background: rgba(255, 255, 255, 0.5); }
    }

    /* Pose ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .pose-button {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 24px;
      font-size: 18px;
      font-weight: bold;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      z-index: 1000;
    }

    .pose-button:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
    }

    .pose-button:active {
      transform: translateY(0);
    }

    /* í¬ì¦ˆ ì´ë¯¸ì§€ í‘œì‹œ ì˜ì—­ */
    .pose-images-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      display: none;
      max-width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .pose-images-container.active {
      display: block;
      animation: fadeInScale 0.3s ease-out;
    }

    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.8);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }

    .pose-images-title {
      font-size: 24px;
      font-weight: bold;
      color: #ffffff;
      margin-bottom: 20px;
      text-align: center;
    }

    .pose-images-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }

    .pose-image-item {
      text-align: center;
    }

    .pose-image-item img {
      width: 100%;
      max-width: 300px;
      height: auto;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      margin-bottom: 10px;
    }

    .pose-image-label {
      font-size: 18px;
      font-weight: bold;
      color: #002fff;
    }

    .pose-close-button {
      width: 100%;
      padding: 12px;
      font-size: 18px;
      font-weight: bold;
      color: #000000;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .pose-close-button:hover {
      background: linear-gradient(135deg, #fee140 0%, #fa709a 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(250, 112, 154, 0.6);
    }

    /* ëª¨ë‹¬ ë°°ê²½ ì˜¤ë²„ë ˆì´ */
    .pose-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1999;
      display: none;
    }

    .pose-overlay.active {
      display: block;
    }

    </style>
  </head>
  <body>
  <!-- ë©”ì¸ í™”ë©´ -->
  <div id="mainScreen">
    <button class="difficulty-button" onclick="startQuiz('easy')">ë‚œì´ë„ í•˜</button>
    <button class="difficulty-button" onclick="startQuiz('medium')">ë‚œì´ë„ ì¤‘</button>
    <button class="difficulty-button" onclick="startQuiz('hard')">ë‚œì´ë„ ìƒ</button>
  </div>

  <!-- ì‹œì‘ ì„¤ëª… ì˜¤ë²„ë ˆì´ -->
  <div class="start-overlay" id="startOverlay">
    <div class="start-overlay-content">
      <div class="start-overlay-description">
        í¬ì¦ˆ ê°€ì´ë“œë¥¼ ë°˜ë“œì‹œ í™•ì¸ í›„ í€´ì¦ˆë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.
      </div>
      <button class="start-overlay-button" onclick="closeStartOverlay()">ì‹œì‘í•˜ê¸°</button>
    </div>
  </div>

  <!-- ë‚œì´ë„ í•˜ í™”ë©´ -->
  <div id="easyScreen" class="quiz-screen">
    <button class="back-button" onclick="goBack()">â† ë’¤ë¡œê°€ê¸°</button>
    <button class="pose-button" onclick="showPoseImages()">ë‹µë³€ ì„ íƒ ê°€ì´ë“œ</button>
    <div class="welcome-message">ì„œìš¸ì‹œë¦½ëŒ€ì— ê´€í•œ ì´ˆì„± í€´ì¦ˆì…ë‹ˆë‹¤.</div>
    <div id="easyQuestions" class="question-container"></div>
  </div>

  <!-- ë‚œì´ë„ ì¤‘ í™”ë©´ -->
  <div id="mediumScreen" class="quiz-screen">
    <button class="back-button" onclick="goBack()">â† ë’¤ë¡œê°€ê¸°</button>
    <button class="pose-button" onclick="showPoseImages()">ë‹µë³€ ì„ íƒ ê°€ì´ë“œ</button>
    <div class="welcome-message">ì„œìš¸ì‹œë¦½ëŒ€ì— ê´€í•œ í€´ì¦ˆì…ë‹ˆë‹¤.</div>
    <div id="mediumQuestions" class="question-container"></div>
  </div>

  <!-- ë‚œì´ë„ ìƒ í™”ë©´ -->
  <div id="hardScreen" class="quiz-screen">
    <button class="back-button" onclick="goBack()">â† ë’¤ë¡œê°€ê¸°</button>
    <button class="pose-button" onclick="showPoseImages()">ë‹µë³€ ì„ íƒ ê°€ì´ë“œ</button>
    <div class="welcome-message">'ì´ì‹œë„¤'ì— ëŒ€í•œ í€´ì¦ˆì…ë‹ˆë‹¤</div>
    <div id="hardQuestions" class="question-container"></div>
  </div>

  <!-- í¬ì¦ˆ ì´ë¯¸ì§€ í‘œì‹œ ì˜ì—­ -->
  <div class="pose-overlay" id="poseOverlay" onclick="hidePoseImages()"></div>
  <div class="pose-images-container" id="poseImagesContainer">
    <div class="pose-images-title">ë‹µë³€ ì„ íƒ ê°€ì´ë“œ</div>
    <div class="pose-images-grid">
      <div class="pose-image-item">
        <img src="./1n.png" alt="1ë²ˆ í¬ì¦ˆ">
        <div class="pose-image-label">1ë²ˆ</div>
      </div>
      <div class="pose-image-item">
        <img src="./2n.png" alt="2ë²ˆ í¬ì¦ˆ">
        <div class="pose-image-label">2ë²ˆ</div>
      </div>
      <div class="pose-image-item">
        <img src="./3n.png" alt="3ë²ˆ í¬ì¦ˆ">
        <div class="pose-image-label">3ë²ˆ</div>
      </div>
      <div class="pose-image-item">
        <img src="./4n.png" alt="4ë²ˆ í¬ì¦ˆ">
        <div class="pose-image-label">4ë²ˆ</div>
      </div>
    </div>
    <button class="pose-close-button" onclick="hidePoseImages()">ë‹«ê¸°</button>
  </div>

  <!-- ì›¹ìº  ë° ì˜ˆì¸¡ ì •ë³´ -->
  <div class="camera-container" id="cameraContainer" style="display: none;">
    <video id="webcam" autoplay playsinline></video>
  </div>
  <div class="prediction-info" id="predictionInfo" style="display: none;">
    <div>í¬ì¦ˆ ì¸ì‹ ê²°ê³¼:</div>
    <div id="predictions"></div>
  </div>


  <script>
    // Teachable Machine ê´€ë ¨ ë³€ìˆ˜
    let model = null;
    let webcam = null;
    let isPredicting = false;
    let lastPrediction = null;
    let predictionCount = 0;
    const PREDICTION_THRESHOLD = 0.5; // ì˜ˆì¸¡ ì‹ ë¢°ë„ ì„ê³„ê°’
    const PREDICTION_COUNT_THRESHOLD = 5; // ì—°ì† ì˜ˆì¸¡ íšŸìˆ˜

    // Teachable Machine ëª¨ë¸ ë¡œë“œ (Pose ëª¨ë¸ - í¬ì¦ˆ ì¸ì‹)
    async function initTeachableMachine() {
      // ğŸ“Œ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì˜ model.jsonê³¼ metadata.json ì‚¬ìš©
      const modelURL = './model.json';
      const metadataURL = './metadata.json';
      
      try {
        if (typeof tmPose === 'undefined') {
          throw new Error("tmPoseê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        }
        console.log("ğŸ“ í¬ì¦ˆ ëª¨ë¸ ë¡œë“œ ì‹œë„ ì¤‘...");
        console.log("   ëª¨ë¸ URL:", modelURL);
        console.log("   ë©”íƒ€ë°ì´í„° URL:", metadataURL);
        
        model = await tmPose.load(modelURL, metadataURL);
        console.log("âœ… Teachable Machine Pose ëª¨ë¸ ë¡œë“œ ì™„ë£Œ");
        console.log("   ëª¨ë¸ í´ë˜ìŠ¤ ìˆ˜:", model.getTotalClasses());
        console.log("   í´ë˜ìŠ¤ ëª©ë¡:", model.getClassLabels());
        
        await initWebcam();
      } catch (error) {
        console.error("ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨:", error);
        console.log("ğŸ’¡ ëª¨ë¸ íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
        console.log("   ëª¨ë¸ ê²½ë¡œ:", modelURL);
        console.log("   ë©”íƒ€ë°ì´í„° ê²½ë¡œ:", metadataURL);
        model = null;
      }
    }

    // ì›¹ìº  ì´ˆê¸°í™”
    async function initWebcam() {
      const video = document.getElementById('webcam');
      const container = document.getElementById('cameraContainer');
      
      if (!video || !container) {
        console.error("ì›¹ìº  ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }
      
      if (video.srcObject) {
        const tracks = video.srcObject.getTracks();
        tracks.forEach(track => track.stop());
        video.srcObject = null;
      }
      
      isPredicting = false;
      webcam = null;
      
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ 
          video: { 
            width: { ideal: 640 }, 
            height: { ideal: 480 },
            facingMode: 'user'
          } 
        });
        
        video.srcObject = stream;
        
        await new Promise((resolve, reject) => {
          const timeout = setTimeout(() => {
            reject(new Error("ë¹„ë””ì˜¤ ë¡œë“œ íƒ€ì„ì•„ì›ƒ"));
          }, 5000);
          
          video.onloadedmetadata = () => {
            clearTimeout(timeout);
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth || 640;
            canvas.height = video.videoHeight || 480;
            webcam = { video: video, canvas: canvas };
            
            container.style.display = 'block';
            const predictionInfo = document.getElementById('predictionInfo');
            if (predictionInfo) {
              predictionInfo.style.display = 'block';
            }
            
            resolve();
          };
          
          if (video.readyState >= 2) {
            clearTimeout(timeout);
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth || 640;
            canvas.height = video.videoHeight || 480;
            webcam = { video: video, canvas: canvas };
            container.style.display = 'block';
            const predictionInfo = document.getElementById('predictionInfo');
            if (predictionInfo) {
              predictionInfo.style.display = 'block';
            }
            resolve();
          }
        });
        
        if (model) {
          console.log("ğŸ¬ ì˜ˆì¸¡ ì‹œì‘");
          isPredicting = true;
          predict();
        } else {
          console.warn("âš ï¸ ëª¨ë¸ì´ ë¡œë“œë˜ì§€ ì•Šì•„ ì˜ˆì¸¡ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }
      } catch (error) {
        console.error("ì›¹ìº  ì ‘ê·¼ ì‹¤íŒ¨:", error);
        if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
          alert("ì›¹ìº  ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.");
        } else if (error.name === 'NotFoundError') {
          alert("ì›¹ìº ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        } else {
          alert("ì›¹ìº  ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error.message);
        }
      }
    }

    // ì˜ˆì¸¡ ë£¨í”„ (Pose ëª¨ë¸ - í¬ì¦ˆ ì¸ì‹)
    async function predict() {
      if (!model || !webcam || !isPredicting) {
        if (!model) console.warn("âš ï¸ ëª¨ë¸ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        if (!webcam) console.warn("âš ï¸ ì›¹ìº ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        if (!isPredicting) console.warn("âš ï¸ ì˜ˆì¸¡ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.");
        return;
      }

      const ctx = webcam.canvas.getContext('2d');
      ctx.drawImage(webcam.video, 0, 0, webcam.canvas.width, webcam.canvas.height);
      
      try {
        if (!webcam.video || webcam.video.readyState < 2) {
          requestAnimationFrame(() => predict());
          return;
        }
        
        // Pose ëª¨ë¸: ì›¹ìº  ë¹„ë””ì˜¤ì—ì„œ í¬ì¦ˆ ì˜ˆì¸¡
        const { pose, posenetOutput } = await model.estimatePose(webcam.video);
        const prediction = await model.predict(posenetOutput);
        
        if (prediction && prediction.length > 0) {
          // ë””ë²„ê¹…: ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸ (ê°€ë”ë§Œ ì¶œë ¥)
          if (Math.random() < 0.05) {
            const maxPred = prediction.reduce((max, p) => p.probability > max.probability ? p : max, prediction[0]);
            console.log(`ğŸ“Š ì˜ˆì¸¡: ${maxPred.className} (${(maxPred.probability * 100).toFixed(1)}%)`);
          }
          
          updatePredictionDisplay(prediction);
          handlePosePrediction(prediction);
        } else {
          if (Math.random() < 0.01) {
            console.warn("âš ï¸ ì˜ˆì¸¡ ê²°ê³¼ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");
          }
          const predictionsDiv = document.getElementById('predictions');
          if (predictionsDiv) {
            predictionsDiv.innerHTML = '<div style="color: #ff6b6b;">ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
          }
        }
      } catch (error) {
        console.error("âŒ ì˜ˆì¸¡ ì˜¤ë¥˜:", error);
        console.error("ì—ëŸ¬ ìƒì„¸:", error.message);
        if (error.stack) {
          console.error("ìŠ¤íƒ:", error.stack);
        }
      }
      
      requestAnimationFrame(() => predict());
    }

    // ì˜ˆì¸¡ ê²°ê³¼ í‘œì‹œ
    function updatePredictionDisplay(prediction) {
      const predictionsDiv = document.getElementById('predictions');
      if (!predictionsDiv) return;

      let html = '';
      let highestClass = '';
      let highestProb = 0;

      prediction.forEach((pred) => {
        const prob = (pred.probability * 100).toFixed(1);
        if (pred.probability > highestProb) {
          highestProb = pred.probability;
          highestClass = pred.className;
        }
        html += `<div class="prediction-item ${pred.probability === highestProb ? 'highest' : ''}">
          ${pred.className}: ${prob}%
        </div>`;
      });

      predictionsDiv.innerHTML = html;
      lastPrediction = { class: highestClass, prob: highestProb };
    }

    // í¬ì¦ˆ ì¸ì‹ ê²°ê³¼ë¡œ ë‹µë³€ ì„ íƒ (ëª¨ë“  ë‚œì´ë„ì—ì„œ ì‘ë™)
    function handlePosePrediction(prediction) {
      if (!prediction || prediction.length === 0) return;

      let highestClass = '';
      let highestProb = 0;
      
      prediction.forEach(pred => {
        if (pred.probability > highestProb) {
          highestProb = pred.probability;
          highestClass = pred.className;
        }
      });

      // ë””ë²„ê¹…: ì˜ˆì¸¡ ê²°ê³¼ ì¶œë ¥ (ê°€ë”ë§Œ)
      if (Math.random() < 0.1) {
        console.log(`ğŸ¯ [${currentDifficulty}] ìµœê³  ì˜ˆì¸¡: ${highestClass} (${(highestProb * 100).toFixed(1)}%), ì„ê³„ê°’: ${(PREDICTION_THRESHOLD * 100).toFixed(1)}%, ì—°ì†: ${predictionCount}/${PREDICTION_COUNT_THRESHOLD}`);
      }

      if (highestProb >= PREDICTION_THRESHOLD) {
        if (lastPrediction && lastPrediction.class === highestClass) {
          predictionCount++;
          
          if (predictionCount >= PREDICTION_COUNT_THRESHOLD) {
            console.log(`âœ… [${currentDifficulty}] ë‹µ ì„ íƒ ì‹¤í–‰: ${highestClass} (${(highestProb * 100).toFixed(1)}%)`);
            selectAnswerByPose(highestClass);
            predictionCount = 0;
          }
        } else {
          predictionCount = 1;
        }
      } else {
        predictionCount = 0;
      }
      
      // lastPrediction ì—…ë°ì´íŠ¸
      lastPrediction = { class: highestClass, prob: highestProb };
    }

    // í¬ì¦ˆë¡œ ë‹µë³€ ì„ íƒ (ëª¨ë“  ë‚œì´ë„ì—ì„œ ì‘ë™)
    function selectAnswerByPose(poseClass) {
      const optionNumber = parseInt(poseClass.replace(/[^0-9]/g, ''));
      
      if (optionNumber >= 1 && optionNumber <= 4) {
        const optionIndex = optionNumber - 1;
        selectOption(optionIndex);
        console.log(`âœ… [${currentDifficulty}] í¬ì¦ˆë¡œ ${optionNumber}ë²ˆ ì„ íƒë¨: ${poseClass}`);
      } else {
        console.warn(`âš ï¸ [${currentDifficulty}] ì˜ëª»ëœ í¬ì¦ˆ í´ë˜ìŠ¤: ${poseClass}`);
      }
    }

    // ì§ˆë¬¸ ë°ì´í„° - ì—¬ê¸°ì— ì§ˆë¬¸ì„ ì¶”ê°€í•˜ì„¸ìš”!
    // ê°ê´€ì‹ í˜•ì‹: { question: "ì§ˆë¬¸", answer: "ì •ë‹µ", options: ["ì„ íƒì§€1", "ì„ íƒì§€2", "ì„ íƒì§€3", "ì„ íƒì§€4"] }
    const quizData = {
      easy: [
        { 
          question: "ã……ã…‡ã……ã„¹ã„·ã…ã„±", 
          answer: "1ë²ˆ: ì„œìš¸ì‹œë¦½ëŒ€í•™êµ",
          options: ["1ë²ˆ: ì„œìš¸ì‹œë¦½ëŒ€í•™êµ", "2ë²ˆ: ì„œìš¸ì‚¬ë‘ëŒ€í•™êµ", "3ë²ˆ: ì„œìš¸ì‹œëŸ¬ëŒ€í•™êµ", "4ë²ˆ: ì‹œë¦½ì‚¬ë‘ëŒ€í•™êµ"]
        },
        { 
          question: "ã…‡ã……ã…Šã…‡ã„·", 
          answer: "2ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€",
          options: ["1ë²ˆ: ì˜ˆìˆ ì¹˜ì˜ëŒ€ ", "2ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€", "3ë²ˆ: ì˜ˆìˆ ì´ˆìƒëŒ€", "4ë²ˆ: ìš”ì–‘ì²´ìœ¡ëŒ€"]
        },
        { 
          question: "ã…‡ã…‡ã…‡ã…‡ã……ã„¹ã…", 
          answer: "2ë²ˆ: ì—ì´ì•„ì´ì‚¬ë‘í•´",
          options: ["1ë²ˆ: ì—ì´ì•„ì´ì‹œë¡œí•´", "2ë²ˆ: ì—ì´ì•„ì´ì‚¬ë‘í•´", "3ë²ˆ: ì—ì´ì•„ì´ì†Œë‘í•´", "4ë²ˆ: ì—ì´ì•„ì´ì†Œë¼í•´"]
        },
        { 
          question: "ã…ã„´ã…", 
          answer: "4ë²ˆ: í•˜ëŠ˜ëª»",
          options: ["1ë²ˆ: í•˜ëŠ˜ë§›", "2ë²ˆ: í•˜ëŠ˜ë­", "3ë²ˆ: í•˜ë‚˜ë§Œ", "4ë²ˆ: í•˜ëŠ˜ëª»"]
        },
        { 
          question: "ã„·ã„·ã…ã„±", 
          answer: "3ë²ˆ: ë™ëŒ€ë¬¸êµ¬",
          options: ["1ë²ˆ: ë™ëŒ€ë¬¸ë™", "2ë²ˆ: ë™ëŒ€ë¬¸ì‹œ", "3ë²ˆ: ë™ëŒ€ë¬¸êµ¬", "4ë²ˆ: ë™ëŒ€ë¬¸ë©´"]
        },
        { 
          question: "ã…‡ã……ã…Šã…‡ã„·ã…", 
          answer: "2ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€í•™",
          options: ["1ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€í•™ì›", "2ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€í•™", "3ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€í•™êµ", "4ë²ˆ: ì˜ˆìˆ ì²´ìœ¡ëŒ€í•™ë¶€"]
        },
        { 
          question: "UOS", 
          answer: "1ë²ˆ: U, UOR STAR",
          options: ["1ë²ˆ: U, UOR STAR", "2ë²ˆ: U, UOR SEOUL", "3ë²ˆ: U, UOR START", "4ë²ˆ: U, UOR SOUND"]
        },
        { 
          question: "ã…", 
          answer: "1ë²ˆ: ë§¤",
          options: ["1ë²ˆ: ë§¤", "2ë²ˆ: ë…ìˆ˜ë¦¬", "3ë²ˆ: ë¹„ë‘˜ê¸°", "4ë²ˆ: ì°¸ìƒˆ"]
        },
        { 
          question: "ã…‡ã…ã…ˆ", 
          answer: "3ë²ˆ: ì¸í–¥ì œ",
          options: ["1ë²ˆ: ì€í•˜ì§€", "2ë²ˆ: ì€í•˜ì œ", "3ë²ˆ: ì¸í–¥ì œ", "4ë²ˆ: ì•ˆí–¥ì œ"]
        },
        { 
          question: "ã„·ã……ã…ã„±ã……ã…‡ã„·", 
          answer: "2ë²ˆ: ë„ì‹œì™€í•¨ê»˜ì„±ì¥í•˜ëŠ”ëŒ€í•™",
          options: ["1ë²ˆ: ë„ì‹œì™€í•¨ê»˜ë°œì „í•˜ëŠ”ëŒ€í•™", "2ë²ˆ: ë„ì‹œì™€í•¨ê»˜ì„±ì¥í•˜ëŠ”ëŒ€í•™", "3ë²ˆ: ë„ì‹œì™€í•¨ê»˜ì„±ì¥í•˜ëŠ”í•™êµ", "4ë²ˆ: ë„ì‹œì™€í•¨ê»˜ì„±ì¥í•˜ëŠ”ê¸°ê´€"]
        },
        { 
          question: "ã…ã„¹ã……", 
          answer: "4ë²ˆ: íŒŒë€ìƒ‰",
          options: ["1ë²ˆ: ë¹¨ê°„ìƒ‰", "2ë²ˆ: ì´ˆë¡ìƒ‰", "3ë²ˆ: ë…¸ë€ìƒ‰", "4ë²ˆ: íŒŒë€ìƒ‰"]
        },
      ],
      medium: [
        { 
          question: "ì„œìš¸ì‹œë¦½ëŒ€ í•™ìƒì„ ë­ë¼ê³  ë¶€ë¥¼ê¹Œìš”?", 
          answer: "4ë²ˆ: ì‹œëŒ€ìƒ",
          options: ["1ë²ˆ: ì‹œëŒ€ì˜ë³„", "2ë²ˆ: ì‹œëŒ€ë¬¼", "3ë²ˆ: ì‹œëŒ€ì‚¬", "4ë²ˆ: ì‹œëŒ€ìƒ"]
        },
        { 
          question: "ì„œìš¸ì‹œë¦½ëŒ€ì˜ ìœ ì¼í•œ ëŒ„ìŠ¤ ë™ì•„ë¦¬ ì´ë¦„ì€?", 
          answer: "3ë²ˆ: RAH",
          options: ["1ë²ˆ: UDG", "2ë²ˆ: UOD", "3ë²ˆ: RAH", "4ë²ˆ: URH"]
        },
        { 
          question: "ê±´ê³µì´ëŠ” ëˆ„êµ¬ì¼ê¹Œ?", 
          answer: "1ë²ˆ: ê±´ê³µê´€ì— ì‚¬ëŠ” ê³ ì–‘ì´",
          options: ["1ë²ˆ: ê±´ê³µê´€ì— ì‚¬ëŠ” ê³ ì–‘ì´", "2ë²ˆ: ê±´ê³µê´€ì— ì‚¬ëŠ” ê³ ìŠ´ë„ì¹˜", "3ë²ˆ: ê±´ê³µê´€ì— ìì£¼ ë³´ì´ëŠ” ê³µ", "4ë²ˆ: ê±´ì¶•ê³µí•™ê´€ì„ ëœ»í•¨"]
        },
        { 
          question: "ì´ë£¨ë§¤ëŠ” ê·€ì—½ë‚˜ìš”?", 
          answer: "3ë²ˆ: ë„¤ë‹ˆìš”",
          options: ["1ë²ˆ: ë„¤", "2ë²ˆ: ì•„ë‹ˆìš”", "3ë²ˆ: ë„¤ë‹ˆìš”", "4ë²ˆ: ì•„ë‹ˆì˜ˆ"]
        },
        { 
          question: "ì´ë£¨ë§¤ëŠ” í•­ìƒ ì›ƒê³  ìˆì„ê¹Œìš”?", 
          answer: "3ë²ˆ: ì•„ë§ˆë„??",
          options: ["1ë²ˆ: í ,,", "2ë²ˆ: ê¸€ì„ìš”,,", "3ë²ˆ: ì•„ë§ˆë„??", "4ë²ˆ: ë„¤ë‹ˆìš”!"]
        },
        { 
          question: "ê±´ê³µì´ëŠ” ë¬´ìŠ¨ ìƒ‰?", 
          answer: "1ë²ˆ: ì£¼í™©ìƒ‰",
          options: ["1ë²ˆ: ì£¼í™©ìƒ‰", "2ë²ˆ: ê²€ì€ìƒ‰", "3ë²ˆ: ë¹¨ê°„ìƒ‰", "4ë²ˆ: í°ìƒ‰"]
        },
        { 
          question: "ì„œìš¸ì‹œë¦½ëŒ€ì— ì—†ëŠ” ë™ì•„ë¦¬ëŠ”?", 
          answer: "3ë²ˆ: ìŠ¤ì¼€ì´íŠ¸ ë™ì•„ë¦¬",
          options: ["1ë²ˆ: ìŠ¤ì¿ ë²„ ë‹¤ì´ë¹™ ë™ì•„ë¦¬", "2ë²ˆ: ìì „ê±° ë™ì•„ë¦¬", "3ë²ˆ: ìŠ¤ì¼€ì´íŠ¸ ë™ì•„ë¦¬", "4ë²ˆ: ì•¼ìƒì¡°ë¥˜ ì—°êµ¬ ë™ì•„ë¦¬"]
        },
      ],
      hard: [
      { 
          question: "ì´ì‹œë„¤ì˜ í‚¤ëŠ” ëª‡ cmì¼ê¹Œìš”?", 
          answer: "3ë²ˆ: 168cm",
          options: ["1ë²ˆ: 166cm", "2ë²ˆ: 167cm", "3ë²ˆ: 168cm", "4ë²ˆ: 170cm"]
        },
        { 
          question: "ì´ì‹œë„¤ì˜ ì œì¼ ì¢‹ì•„í•˜ëŠ” ìŠ¤ë¬´ë””ëŠ”?", 
          answer: "1ë²ˆ: ë§ê³  ìŠ¤ë¬´ë””",
          options: ["1ë²ˆ: ë§ê³  ìŠ¤ë¬´ë””", "2ë²ˆ: ìš”ê±°íŠ¸ ìŠ¤ë¬´ë””", "3ë²ˆ: í‚¤ìœ„ ìŠ¤ë¬´ë””", "4ë²ˆ: ë”¸ê¸° ìŠ¤ë¬´ë””"]
        },
        { 
          question: "ì´ì‹œë„¤ì˜ ì¢‹ì•„í•˜ëŠ” ì»¬ëŸ¬ëŠ”?", 
          answer: "4ë²ˆ: ë³´ë¼",
          options: ["1ë²ˆ: ê²€ì •", "2ë²ˆ: í•‘í¬", "3ë²ˆ: ë¸”ë£¨", "4ë²ˆ: ë³´ë¼"]
        },
        { 
          question: "ì´ì‹œë„¤ì˜ ì¢‹ì•„í•  ê²ƒ ê°™ì€ ì·¨ë¯¸ëŠ”?", 
          answer: "1ë²ˆ: ìì „ê±° íƒ€ê¸°",
          options: ["1ë²ˆ: ìì „ê±° íƒ€ê¸°", "2ë²ˆ: ë…ì„œ í•˜ê¸°", "3ë²ˆ: ì˜í™”ê´€ ê°€ê¸°", "4ë²ˆ: ê²Œì„ í•˜ê¸°"]
        },
        { 
          question: "ì´ì‹œë„¤ì˜ ì˜¤ëŠ˜ ëª‡ì‹œê°„ ì¤ì„ê¹Œìš”?", 
          answer: "4ë²ˆ: 2ì‹œê°„",
          options: ["1ë²ˆ: 6ì‹œê°„", "2ë²ˆ: 9ì‹œê°„", "3ë²ˆ: 4ì‹œê°„", "4ë²ˆ: 2ì‹œê°„"]
        },
      ]
    };

    let currentDifficulty = null;
    let currentQuestionIndex = 0;
    let currentQuestions = [];

    // í€´ì¦ˆ ì‹œì‘
    function startQuiz(difficulty) {
      currentDifficulty = difficulty;
      currentQuestionIndex = 0;
      currentQuestions = quizData[difficulty];

      // ë©”ì¸ í™”ë©´ ìˆ¨ê¸°ê¸°
      document.getElementById('mainScreen').style.display = 'none';

      // í•´ë‹¹ ë‚œì´ë„ í™”ë©´ í‘œì‹œ
      const screenId = difficulty + 'Screen';
      document.getElementById(screenId).classList.add('active');

      // Teachable Machine ì´ˆê¸°í™” (ëª¨ë“  ë‚œì´ë„ì—ì„œ í¬ì¦ˆ ì¸ì‹ í™œì„±í™”)
      console.log(`ğŸ® ${difficulty} ë‚œì´ë„ í€´ì¦ˆ ì‹œì‘ - í¬ì¦ˆ ì¸ì‹ í™œì„±í™”`);
      if (!model) {
        initTeachableMachine();
      } else {
        // ëª¨ë¸ì´ ì´ë¯¸ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ì›¹ìº ë§Œ ì¬ì‹œì‘
        initWebcam();
      }

      // ì§ˆë¬¸ í‘œì‹œ
      showQuestion();
    }

    // ì§ˆë¬¸ í‘œì‹œ
    function showQuestion() {
      if (currentQuestionIndex >= currentQuestions.length) {
        // ëª¨ë“  ì§ˆë¬¸ ì™„ë£Œ
        showCompletion();
        return;
      }

      const question = currentQuestions[currentQuestionIndex];
      const containerId = currentDifficulty + 'Questions';
      const container = document.getElementById(containerId);

      // ê°ê´€ì‹ ì„ íƒì§€ ìƒì„±
      let optionsHTML = '';
      if (question.options && question.options.length > 0) {
        optionsHTML = '<div class="options-container">';
        question.options.forEach((option, index) => {
          optionsHTML += `
            <button class="option-button" id="option${index}">
              ${option}
            </button>
          `;
        });
        optionsHTML += '</div>';
      }

      container.innerHTML = `
        <div class="question-number">ì§ˆë¬¸ ${currentQuestionIndex + 1} / ${currentQuestions.length}</div>
        <div class="question-text">${question.question}</div>
        ${optionsHTML}
        <button class="submit-button" id="submitBtn" onclick="checkAnswer()" disabled>ë‹µë³€ ì œì¶œ</button>
        <div id="resultMessage"></div>
      `;

      container.classList.add('active');

      // ë‚œì´ë„ ìƒ: ë‹µì§€ ë°•ìŠ¤ë“¤ì„ ëœë¤ ìœ„ì¹˜ì— ë°°ì¹˜í•˜ê³  ì›€ì§ì´ê²Œ í•¨
      if (currentDifficulty === 'hard') {
        setTimeout(() => {
          initRandomButtonMovement(container);
        }, 100);
      }
    }

    // ë‚œì´ë„ ìƒ: ëœë¤ ì›€ì§ì„ ì´ˆê¸°í™” (ì›¹ìº  ì˜ì—­ í”¼í•˜ê¸°)
    let movingButtons = [];
    let animationFrameId = null;

    function initRandomButtonMovement(container) {
      // ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
      if (animationFrameId) {
        cancelAnimationFrame(animationFrameId);
      }
      movingButtons = [];

      const buttons = container.querySelectorAll('.option-button');
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      const buttonWidth = 300;
      const buttonHeight = 80;
      
      // ì›¹ìº  ì˜ì—­ (ìš°ì¸¡ í•˜ë‹¨) ì œì™¸
      const webcamArea = {
        right: screenWidth - 20, // ìš°ì¸¡ ì—¬ë°±
        bottom: 20, // í•˜ë‹¨ ì—¬ë°±
        width: 320, // ì›¹ìº  ë„ˆë¹„
        height: 240 + 50 // ì›¹ìº  ë†’ì´ + ì˜ˆì¸¡ ì •ë³´ ì˜ì—­
      };

      buttons.forEach((btn, index) => {
        let centerX, centerY;
        let attempts = 0;
        
        // ì›¹ìº  ì˜ì—­ì„ í”¼í•˜ëŠ” ëœë¤ ìœ„ì¹˜ ìƒì„±
        
        
        // ë‚œì´ë„ ìƒ: ë²„íŠ¼ì„ absolute ìœ„ì¹˜ë¡œ ì„¤ì •
        btn.style.position = 'absolute';
        btn.style.left = centerX + 'px';
        btn.style.top = centerY + 'px';
        
        // ëœë¤ ì†ë„ì™€ ë°©í–¥ (ê° ë²„íŠ¼ë§ˆë‹¤ ë‹¤ë¥¸ ì†ë„)
        const speedX = (Math.random() - 0.5) * 1; // -1 ~ 1
        const speedY = (Math.random() - 0.5) * 1; // -1 ~ 1
        const rotationSpeed = (Math.random() - 0.5) * 0.5; // íšŒì „ ì†ë„
        
        // ê° ë²„íŠ¼ì˜ ìƒíƒœ ì €ì¥
        movingButtons.push({
          element: btn,
          x: centerX,
          y: centerY,
          speedX: speedX,
          speedY: speedY,
          rotation: 0,
          rotationSpeed: rotationSpeed,
          width: buttonWidth,
          height: buttonHeight
        });
      });

      // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
      animateRandomButtonMovement();
    }

    // ëœë¤ ì›€ì§ì„ ì• ë‹ˆë©”ì´ì…˜ (ì›¹ìº  ì˜ì—­ í”¼í•˜ê¸°)
    function animateRandomButtonMovement() {
      if (movingButtons.length === 0) return;

      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      const webcamArea = {
        right: screenWidth - 20,
        bottom: 20,
        width: 320,
        height: 240 + 50
      };

      movingButtons.forEach(button => {
        // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        button.x += button.speedX;
        button.y += button.speedY;
        button.rotation += button.rotationSpeed;

        // í™”ë©´ ê²½ê³„ì—ì„œ íŠ•ê¸°ê¸°
        if (button.x <= 0 || button.x >= screenWidth - button.width) {
          button.speedX *= -1;
          button.x = Math.max(0, Math.min(screenWidth - button.width, button.x));
        }
        if (button.y <= 100 || button.y >= screenHeight - button.height - 100) {
          button.speedY *= -1;
          button.y = Math.max(100, Math.min(screenHeight - button.height - 100, button.y));
        }

        // ì›¹ìº  ì˜ì—­ê³¼ ì¶©ëŒ ë°©ì§€
        const buttonRight = button.x + button.width;
        const buttonBottom = button.y + button.height;
        const webcamLeft = webcamArea.right - webcamArea.width;
        const webcamTop = screenHeight - webcamArea.height;

        if (buttonRight > webcamLeft && button.x < webcamArea.right && 
            buttonBottom > webcamTop && button.y < screenHeight - webcamArea.bottom) {
          // ì›¹ìº  ì˜ì—­ì— ë“¤ì–´ê°€ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ íŠ•ê¸°ê¸°
          if (button.x < webcamLeft) {
            button.speedX = -Math.abs(button.speedX);
          } else {
            button.speedX = Math.abs(button.speedX);
          }
          if (button.y < webcamTop) {
            button.speedY = -Math.abs(button.speedY);
          } else {
            button.speedY = Math.abs(button.speedY);
          }
        }

        // ìœ„ì¹˜ì™€ íšŒì „ ì ìš©
        button.element.style.left = button.x + 'px';
        button.element.style.top = button.y + 'px';
        button.element.style.transform = `rotate(${button.rotation}deg)`;
      });

      // ë‹¤ìŒ í”„ë ˆì„ ìš”ì²­
      animationFrameId = requestAnimationFrame(animateRandomButtonMovement);
    }

    // ì„ íƒì§€ ì„ íƒ
    let selectedOptionIndex = -1;
    function selectOption(index) {
      console.log(`ğŸ¯ selectOption í˜¸ì¶œ: ë‚œì´ë„=${currentDifficulty}, ì¸ë±ìŠ¤=${index}`);
      
      // ì´ì „ ì„ íƒ í•´ì œ
      document.querySelectorAll('.option-button').forEach(btn => {
        btn.classList.remove('selected');
      });
      
      // í˜„ì¬ ì„ íƒ í‘œì‹œ
      const selectedBtn = document.getElementById('option' + index);
      if (!selectedBtn) {
        console.error(`âŒ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: option${index}`);
        // ë‚œì´ë„ ìƒì˜ ê²½ìš° ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ë‹¤ì‹œ ì‹œë„
        if (currentDifficulty === 'hard') {
          const container = document.getElementById('hardQuestions');
          if (container) {
            const buttons = container.querySelectorAll('.option-button');
            if (buttons[index]) {
              buttons[index].classList.add('selected');
              selectedOptionIndex = index;
              document.getElementById('submitBtn').disabled = false;
              console.log(`âœ… ë‚œì´ë„ ìƒ: ë²„íŠ¼ ì„ íƒ ì„±ê³µ (ì¸ë±ìŠ¤ ${index})`);
              return;
            }
          }
        }
        return;
      }
      
      selectedBtn.classList.add('selected');
      selectedOptionIndex = index;
      
      // ì œì¶œ ë²„íŠ¼ í™œì„±í™”
      const submitBtn = document.getElementById('submitBtn');
      if (submitBtn) {
        submitBtn.disabled = false;
        console.log(`âœ… ë²„íŠ¼ ì„ íƒ ì„±ê³µ: option${index} (ë‚œì´ë„: ${currentDifficulty})`);
      } else {
        console.error(`âŒ ì œì¶œ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`);
      }
    }

    // ë³„ íš¨ê³¼ ìƒì„±
    function createStars(x, y, count = 15) {
      for (let i = 0; i < count; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.textContent = 'â­';
        star.style.left = (x + (Math.random() - 0.5) * 200) + 'px';
        star.style.top = (y + (Math.random() - 0.5) * 200) + 'px';
        star.style.animationDelay = (Math.random() * 0.3) + 's';
        document.body.appendChild(star);
        
        setTimeout(() => star.remove(), 1000);
      }
    }

    // í­ì£½ íš¨ê³¼ ìƒì„±
    function createConfetti(x, y, count = 30) {
      for (let i = 0; i < count; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = (x + (Math.random() - 0.5) * 300) + 'px';
        confetti.style.top = (y + (Math.random() - 0.5) * 300) + 'px';
        confetti.style.animationDelay = (Math.random() * 0.5) + 's';
        confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
        document.body.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 1500);
      }
    }

    // ë°°ê²½ ê¹œë¹¡ì„ íš¨ê³¼
    function flashBackground(isCorrect) {
      const screenId = currentDifficulty + 'Screen';
      const screen = document.getElementById(screenId);
      
      if (isCorrect) {
        screen.classList.add('flash-correct');
      } else {
        screen.classList.add('flash-incorrect');
      }
      
      setTimeout(() => {
        screen.classList.remove('flash-correct', 'flash-incorrect');
      }, 300);
    }

    // í™”ë©´ í”ë“¤ë¦¼ íš¨ê³¼
    function shakeScreen() {
      const screenId = currentDifficulty + 'Screen';
      const screen = document.getElementById(screenId);
      screen.classList.add('shake');
      
      setTimeout(() => {
        screen.classList.remove('shake');
      }, 500);
    }

    // ë‹µë³€ í™•ì¸
    function checkAnswer() {
      if (selectedOptionIndex === -1) {
        alert('ë‹µì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }

      const question = currentQuestions[currentQuestionIndex];
      const userAnswer = question.options[selectedOptionIndex];
      const correctAnswer = question.answer;
      const resultDiv = document.getElementById('resultMessage');

      // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”
      document.getElementById('submitBtn').disabled = true;

      // ê²°ê³¼ ë©”ì‹œì§€ ìœ„ì¹˜ ê³„ì‚° (í™”ë©´ ì¤‘ì•™)
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      const centerX = screenWidth / 2;
      const centerY = screenHeight / 2;

      if (userAnswer === correctAnswer) {
        // ì •ë‹µ ì²˜ë¦¬
        resultDiv.innerHTML = '<div class="result-message correct"><span class="result-icon checkmark-icon">âœ“</span>ì •ë‹µì…ë‹ˆë‹¤!</div>';
        
        // ë°°ê²½ ê¹œë¹¡ì„ (ì´ˆë¡ìƒ‰)
        flashBackground(true);
        
        // ë³„ íš¨ê³¼
        createStars(centerX, centerY, 20);
        
        // í­ì£½ íš¨ê³¼
        createConfetti(centerX, centerY, 40);
        
        setTimeout(() => {
          selectedOptionIndex = -1;
          currentQuestionIndex++;
          showQuestion();
        }, 2000);
      } else {
        // ì˜¤ë‹µ ì²˜ë¦¬
        resultDiv.innerHTML = `<div class="result-message incorrect"><span class="result-icon x-icon">âœ—</span>í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µ: ${correctAnswer}</div>`;
        
        // ë°°ê²½ ê¹œë¹¡ì„ (ë¹¨ê°„ìƒ‰)
        flashBackground(false);
        
        // í™”ë©´ í”ë“¤ë¦¼
        shakeScreen();
        
        setTimeout(() => {
          selectedOptionIndex = -1;
          currentQuestionIndex++;
          showQuestion();
        }, 2500);
      }
    }

    // ì™„ë£Œ í™”ë©´
    function showCompletion() {
      const containerId = currentDifficulty + 'Questions';
      const container = document.getElementById(containerId);

      container.innerHTML = `
        <div class="question-text" style="text-align: center;">
          ëª¨ë“  ì§ˆë¬¸ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!<br>
          ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!
        </div>
        <button class="submit-button" onclick="goBack()">ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      `;
    }

    // ë’¤ë¡œê°€ê¸°
    function goBack() {
      // í¬ì¦ˆ ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸°
      hidePoseImages();
      
      // ëª¨ë“  í€´ì¦ˆ í™”ë©´ ìˆ¨ê¸°ê¸°
      document.querySelectorAll('.quiz-screen').forEach(screen => {
        screen.classList.remove('active');
      });

      // ë©”ì¸ í™”ë©´ í‘œì‹œ
      document.getElementById('mainScreen').style.display = 'flex';

      // ì›¹ìº  ìˆ¨ê¸°ê¸° ë° ì˜ˆì¸¡ ì¤‘ì§€
      isPredicting = false;
      document.getElementById('cameraContainer').style.display = 'none';
      document.getElementById('predictionInfo').style.display = 'none';
      
      // ì›¹ìº  ìŠ¤íŠ¸ë¦¼ ì •ë¦¬
      const video = document.getElementById('webcam');
      if (video && video.srcObject) {
        const tracks = video.srcObject.getTracks();
        tracks.forEach(track => track.stop());
        video.srcObject = null;
      }
      webcam = null;

      // ë‚œì´ë„ í•˜ ëœë¤ ì›€ì§ì„ ì• ë‹ˆë©”ì´ì…˜ ì •ì§€
      if (animationFrameId) {
        cancelAnimationFrame(animationFrameId);
        animationFrameId = null;
      }
      movingButtons = [];

      // ìƒíƒœ ì´ˆê¸°í™”
      currentDifficulty = null;
      currentQuestionIndex = 0;
      currentQuestions = [];
      selectedOptionIndex = -1;
      predictionCount = 0;
      lastPrediction = null;
    }

    // í¬ì¦ˆ ì´ë¯¸ì§€ í‘œì‹œ í•¨ìˆ˜
    function showPoseImages() {
      const container = document.getElementById('poseImagesContainer');
      const overlay = document.getElementById('poseOverlay');
      
      if (container && overlay) {
        container.classList.add('active');
        overlay.classList.add('active');
        console.log('í¬ì¦ˆ ì´ë¯¸ì§€ í‘œì‹œ');
      }
    }

    // í¬ì¦ˆ ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸° í•¨ìˆ˜
    function hidePoseImages() {
      const container = document.getElementById('poseImagesContainer');
      const overlay = document.getElementById('poseOverlay');
      
      if (container && overlay) {
        container.classList.remove('active');
        overlay.classList.remove('active');
        console.log('í¬ì¦ˆ ì´ë¯¸ì§€ ìˆ¨ê¹€');
      }
    }

    // ESC í‚¤ë¡œ í¬ì¦ˆ ì´ë¯¸ì§€ ë‹«ê¸°
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        hidePoseImages();
      }
    });

    // ì‹œì‘ ì˜¤ë²„ë ˆì´ ë‹«ê¸° í•¨ìˆ˜
    function closeStartOverlay() {
      const overlay = document.getElementById('startOverlay');
      if (overlay) {
        overlay.classList.add('hidden');
        console.log('ì‹œì‘ ì˜¤ë²„ë ˆì´ ë‹«í˜');
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹œì‘ ì˜¤ë²„ë ˆì´ í‘œì‹œ
    window.addEventListener('DOMContentLoaded', function() {
      const overlay = document.getElementById('startOverlay');
      if (overlay) {
        overlay.classList.remove('hidden');
        console.log('ì‹œì‘ ì˜¤ë²„ë ˆì´ í‘œì‹œ');
      }
    });

    // ESC í‚¤ë¡œ ì‹œì‘ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        const overlay = document.getElementById('startOverlay');
        if (overlay && !overlay.classList.contains('hidden')) {
          closeStartOverlay();
        }
      }
    });

    // ì§ˆë¬¸ ì¶”ê°€ í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš© ê°€ëŠ¥)
    // ê°ê´€ì‹ í˜•ì‹: addQuestion('easy', 'ì§ˆë¬¸', 'ì •ë‹µ', ['ì„ íƒì§€1', 'ì„ íƒì§€2', 'ì„ íƒì§€3', 'ì„ íƒì§€4'])
    function addQuestion(difficulty, question, answer, options) {
      if (!quizData[difficulty]) {
        console.error('ì˜ëª»ëœ ë‚œì´ë„ì…ë‹ˆë‹¤.');
        return;
      }
      if (!options || options.length === 0) {
        console.error('ì„ íƒì§€(options)ë¥¼ ì œê³µí•´ì£¼ì„¸ìš”.');
        return;
      }
      quizData[difficulty].push({ question, answer, options });
      console.log(`${difficulty} ë‚œì´ë„ì— ì§ˆë¬¸ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
    }
  </script>
  </body>
</html>
